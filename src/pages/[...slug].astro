---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const pages = await getCollection('pages', ({ data }) => {
    return data.draft !== true;
  });

  return pages.map((page) => ({
    params: { slug: page.slug },
    props: { page },
  }));
}

const { page } = Astro.props;
const { Content } = await page.render();
---

<BaseLayout
  title={`${page.data.title} | Dvořákovo gymnázium Kralupy nad Vltavou`}
  description={page.data.description || page.data.title}
>
  <div class="container mx-auto px-4 py-8">
    <article class="max-w-4xl mx-auto">
      <!-- Breadcrumb -->
      <nav class="text-sm text-text-muted mb-6">
        <ol class="flex items-center gap-2">
          <li><a href={import.meta.env.BASE_URL + "/"} class="hover:text-accent-rose">Úvod</a></li>
          {page.data.section && (
            <>
              <li>/</li>
              <li class="capitalize">{page.data.section.replace('-', ' ')}</li>
            </>
          )}
          <li>/</li>
          <li class="text-text-primary">{page.data.title}</li>
        </ol>
      </nav>

      <!-- Page Header -->
      <header class="mb-8">
        <h1 class="text-4xl md:text-5xl font-heading font-thin uppercase text-text-primary border-b-2 border-accent-coral pb-4">
          {page.data.title}
        </h1>
      </header>

      <!-- Page Content -->
      <div class="prose prose-lg max-w-none
        prose-headings:font-heading prose-headings:font-thin prose-headings:uppercase prose-headings:text-text-primary
        prose-h2:text-3xl prose-h2:mt-8 prose-h2:mb-4 prose-h2:border-b prose-h2:border-secondary prose-h2:pb-2
        prose-h3:text-2xl prose-h3:mt-6 prose-h3:mb-3
        prose-p:text-text-secondary prose-p:leading-relaxed prose-p:mb-4
        prose-a:text-accent-rose prose-a:no-underline hover:prose-a:underline
        prose-strong:text-text-primary prose-strong:font-normal
        prose-ul:my-4 prose-li:text-text-secondary
        prose-ol:my-4
      ">
        <Content />
      </div>
    </article>
  </div>
</BaseLayout>
