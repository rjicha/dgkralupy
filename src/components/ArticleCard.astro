---
import type { CollectionEntry } from 'astro:content';
import ResponsiveImage from './ResponsiveImage.astro';

interface Props {
  article: CollectionEntry<'articles'>['data'];
  slug: string;
  featured?: boolean;
}

const { article, slug, featured = false } = Astro.props;
---

<article class={`bg-bg-content border border-border-light overflow-hidden transition-shadow hover:shadow-lg ${featured ? 'md:col-span-2' : ''}`}>
  <!-- Image -->
  <div class="relative overflow-hidden bg-border-light aspect-video">
    {article.image ? (
      <ResponsiveImage
        image={article.image}
        variant="card"
        loading="lazy"
        class="w-full h-full object-cover"
      />
    ) : (
      <div class="w-full h-full flex items-center justify-center bg-primary-dark">
        <img
          src="/images/dg-logo.png"
          alt="Dvořákovo gymnázium logo"
          class="w-32 h-auto object-contain opacity-70"
          loading="lazy"
        />
      </div>
    )}

    {/* Important badge */}
    {article.important && (
      <div class="absolute top-2 right-2">
        <span class="bg-accent-coral text-white px-3 py-1 text-xs font-normal uppercase">
          Důležité
        </span>
      </div>
    )}
  </div>

  <!-- Content -->
  <div class="p-4">
    <!-- Title -->
    <h3 class={`font-heading font-thin uppercase mb-2 ${featured ? 'text-xl' : 'text-lg'}`}>
      <a href={import.meta.env.BASE_URL + `/aktualne/${slug}`} class="text-text-primary hover:text-accent-rose transition-colors">
        {article.title}
      </a>
    </h3>

    <!-- Metadata -->
    <div class="flex items-center gap-3 mb-3 text-xs text-text-muted uppercase">
      <time datetime={article.publishedAt}>{article.publishedAt}</time>
      <span>•</span>
      <span>{article.author}</span>
    </div>

    <!-- Tags -->
    {article.tags && article.tags.length > 0 && (
      <div class="flex flex-wrap gap-2 mb-3">
        {article.tags.map((tag) => (
          <span class="inline-block px-2 py-1 text-xs bg-bg-page text-text-secondary border border-border-light">
            {tag}
          </span>
        ))}
      </div>
    )}

    <!-- Excerpt -->
    <p class="text-sm text-text-secondary mb-3 leading-relaxed">
      {article.excerpt}
    </p>

    <!-- Read more link -->
    <a
      href={import.meta.env.BASE_URL + `/aktualne/${slug}`}
      class="inline-flex items-center text-sm text-accent-rose hover:underline font-normal"
    >
      Číst více
      <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
      </svg>
    </a>
  </div>
</article>
